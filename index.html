<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Fire Protection System Check Sheet</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        body {
            font-family: sans-serif;
            background-color: #f4f4f4;
            padding: 20px;
        }
        .container {
            background: #fff;
            padding: 20px;
            max-width: 700px;
            margin: auto;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        label, select, input {
            display: block;
            margin-top: 10px;
            width: 100%;
        }
        button {
            margin-top: 15px;
            padding: 10px;
        }
        .result, .nfpa-table {
            margin-top: 30px;
            padding: 15px;
            background-color: #eef;
            border-radius: 8px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        th, td {
            border: 1px solid #999;
            padding: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
<div class="container">
    <h2>‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á</h2>
    <label>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó Hazard Class (‡∏ï‡∏≤‡∏° NFPA 13):</label>
    <select id="hazard">
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å --</option>
        <option value="light">Light Hazard</option>
        <option value="oh1">Ordinary Hazard Group 1 (OH1)</option>
        <option value="oh2">Ordinary Hazard Group 2 (OH2)</option>
    </select>

    <label>‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô (Area of Operation, ft¬≤):</label>
    <input type="number" id="ao" placeholder="‡πÄ‡∏ä‡πà‡∏ô 1500">

    <label>‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏´‡∏±‡∏ß‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ (Spacing S & L, ft):</label>
    <input type="number" id="spacingS" placeholder="Spacing S">
    <input type="number" id="spacingL" placeholder="Spacing L">

    <button onclick="calculate()">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
    <button onclick="resetForm()">‡∏£‡∏µ‡πÄ‡∏ã‡∏ï</button>
    <button onclick="exportPDF()">‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å PDF</button>

    <div class="result" id="results" style="display:none;"></div>

    <div class="nfpa-table">
        <h4>üìò ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (NFPA 13)</h4>
        <table>
            <thead>
                <tr>
                    <th>Hazard Class</th>
                    <th>Density (gpm/ft¬≤)</th>
                    <th>Area of Operation (ft¬≤)</th>
                    <th>Hose Demand (gpm)</th>
                </tr>
            </thead>
            <tbody>
                <tr><td>Light Hazard</td><td>0.10</td><td>1500</td><td>100</td></tr>
                <tr><td>OH1</td><td>0.15</td><td>1500</td><td>250</td></tr>
                <tr><td>OH2</td><td>0.20</td><td>1500</td><td>250</td></tr>
            </tbody>
        </table>
    </div>
</div>

<script>
function calculate() {
    const hazard = document.getElementById('hazard').value;
    const ao = parseFloat(document.getElementById('ao').value);
    const spacingS = parseFloat(document.getElementById('spacingS').value);
    const spacingL = parseFloat(document.getElementById('spacingL').value);

    if (!hazard || isNaN(ao) || isNaN(spacingS) || isNaN(spacingL)) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì');
        return;
    }

    let density = 0;
    let hose = 0;
    if (hazard === "light") {
        density = 0.10;
        hose = 100;
    } else if (hazard === "oh1") {
        density = 0.15;
        hose = 250;
    } else if (hazard === "oh2") {
        density = 0.20;
        hose = 250;
    }

    const sprinklerDemand = ao * density;
    const totalDemand = sprinklerDemand + hose;
    const headCount = Math.ceil(ao / (spacingS * spacingL));
    const endPressure = Math.pow((7 / spacingS), 1.85) * 1.5;

    let resultHTML = `
        üîç <b>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Calculation Result)</b><br>
        - Sprinkler Demand: ${sprinklerDemand.toFixed(2)} GPM<br>
        - Hose Demand: ${hose} GPM<br>
        - Total Water Demand: <b>${totalDemand.toFixed(2)} GPM</b><br>
        - ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏•‡∏≠‡∏£‡πå‡∏ó‡∏≥‡∏á‡∏≤‡∏ô: ${headCount} ‡∏´‡∏±‡∏ß<br>
        - ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢‡∏™‡∏∏‡∏î: ${endPressure.toFixed(2)} psi<br>
        - üîß ‡∏Ç‡∏ô‡∏≤‡∏î Fire Pump ‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: <b>${Math.ceil(totalDemand / 50) * 50} GPM</b>
    `;

    document.getElementById('results').style.display = 'block';
    document.getElementById('results').innerHTML = resultHTML;
}

function resetForm() {
    document.getElementById('hazard').value = "";
    document.getElementById('ao').value = "";
    document.getElementById('spacingS').value = "";
    document.getElementById('spacingL').value = "";
    document.getElementById('results').style.display = 'none';
}

function exportPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    doc.setFontSize(14);
    doc.text("Fire Protection System Check Sheet", 20, 20);
    doc.setFontSize(10);
    doc.text(`Hazard: ${document.getElementById('hazard').value}`, 20, 30);
    doc.text(`Area of Operation: ${document.getElementById('ao').value} ft¬≤`, 20, 35);
    doc.text(`Spacing S: ${document.getElementById('spacingS').value} ft`, 20, 40);
    doc.text(`Spacing L: ${document.getElementById('spacingL').value} ft`, 20, 45);

    const resHTML = document.getElementById('results').innerHTML.replace(/<br>/g, '\n').replace(/<[^>]+>/g, '');
    doc.text(resHTML, 20, 60);

    doc.autoTable({
        startY: 120,
        head: [['Hazard Class', 'Density (gpm/ft¬≤)', 'Area (ft¬≤)', 'Hose Demand (gpm)']],
        body: [
            ['Light Hazard', '0.10', '1500', '100'],
            ['OH1', '0.15', '1500', '250'],
            ['OH2', '0.20', '1500', '250']
        ]
    });

    doc.save('Fire_Protection_Check_Sheet.pdf');
}
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πç‡πâ‡∏≤</title>
    <style>
        :root {
            --primary-color: #005A9E;
            --secondary-color: #1E88E5;
            --background-color: #f4f7fc;
            --card-background: #ffffff;
            --text-color: #333333;
            --label-color: #555555;
            --border-color: #e0e0e0;
            --success-color: #2E7D32;
            --warning-color: #D32F2F;
            --info-color: #0288D1;
            --box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            --border-radius: 8px;
        }

        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@400;500;700&display=swap');

        body {
            font-family: 'Sarabun', sans-serif;
            background-color: var(--background-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }

        .container {
            width: 100%;
            max-width: 900px;
            margin-bottom: 30px;
        }

        .calculator-container, .guidance-container {
            background-color: var(--card-background);
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
        }

        header {
            background-color: var(--primary-color);
            color: white;
            padding: 20px 30px;
            text-align: center;
        }

        header h1 {
            margin: 0;
            font-size: 1.8em;
            font-weight: 700;
        }

        header p {
            margin: 5px 0 0;
            opacity: 0.9;
        }

        main {
            padding: 30px;
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 800px) {
            main {
                grid-template-columns: 1fr 1fr;
                align-items: start;
            }
        }

        fieldset {
            border: 1px solid var(--border-color);
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 0;
        }

        legend {
            font-size: 1.2em;
            font-weight: 700;
            color: var(--primary-color);
            padding: 0 10px;
        }
        
        .input-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .form-group { margin-bottom: 20px; }
        .form-group:last-child { margin-bottom: 0; }
        .form-group.full-width { grid-column: 1 / -1; }

        label {
            display: flex;
            align-items: center;
            font-weight: 500;
            color: var(--label-color);
            margin-bottom: 8px;
        }

        .label-text {
            display: block;
        }
        .label-eng {
            font-size: 0.8em;
            color: #999;
            font-weight: 400;
        }

        .tooltip-icon {
            position: relative;
            display: inline-block;
            width: 16px;
            height: 16px;
            background-color: #ccc;
            color: white;
            border-radius: 50%;
            text-align: center;
            font-size: 12px;
            line-height: 16px;
            cursor: help;
            margin-left: 8px;
        }

        .tooltip-text {
            visibility: hidden;
            width: 220px;
            background-color: #333;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -110px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85em;
            font-weight: 400;
        }
        
        .tooltip-text::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -5px;
            border-width: 5px;
            border-style: solid;
            border-color: #333 transparent transparent transparent;
        }

        .tooltip-icon:hover .tooltip-text {
            visibility: visible;
            opacity: 1;
        }

        .guidance-text { font-size: 0.8em; color: var(--label-color); margin-top: 5px; }
        
        input[type="number"], select {
            width: 100%; padding: 10px; border: 1px solid var(--border-color);
            border-radius: 6px; font-size: 1em; box-sizing: border-box;
            transition: border-color 0.3s, box-shadow 0.3s;
        }
        select { background-color: white; }
        input:focus, select:focus {
            outline: none; border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(30, 136, 229, 0.2);
        }
        input[readonly] { background-color: #e9ecef; cursor: not-allowed; font-weight: bold; }

        .result-group { background-color: #f9f9f9; padding: 15px; border-radius: 6px; border: 1px solid var(--border-color); }
        .result-group .label { font-weight: 500; color: var(--label-color); margin-bottom: 8px; }
        .result-value { font-size: 1.3em; font-weight: 700; color: var(--primary-color); display: flex; justify-content: space-between; align-items: baseline; flex-wrap: wrap; }
        .result-value .metric { font-size: 0.8em; font-weight: 400; color: var(--label-color); }
        
        .info-box, .pressure-warning, .pressure-ok, .suggestion-box { 
            margin-top: 10px; padding: 12px; border-radius: 6px; font-size: 0.9em; 
            text-align: center; display: none; overflow-wrap: break-word; line-height: 1.5;
        }
        .info-box { background-color: #E1F5FE; border: 1px solid var(--info-color); color: #01579B; }
        .pressure-warning { background-color: #FFF3E0; border: 1px solid #FFB74D; color: #E65100; }
        .pressure-ok { background-color: #E8F5E9; border: 1px solid var(--success-color); color: var(--success-color); }
        .suggestion-box { background-color: #E3F2FD; border: 1px solid var(--secondary-color); color: var(--primary-color); font-weight: 500; text-align: left; padding-left: 15px; padding-right: 15px;}

        .export-section {
            margin-top: 20px;
            padding: 20px;
            background-color: #f9f9f9;
            border-top: 1px solid var(--border-color);
            text-align: center;
        }
        .export-section button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1em;
            font-family: 'Sarabun', sans-serif;
            border-radius: 6px;
            cursor: pointer;
            margin: 5px;
            transition: background-color 0.3s;
        }
        .export-section button.pdf:hover {
            background-color: var(--secondary-color);
        }
        .export-section button.excel {
            background-color: #1D6F42;
        }
        .export-section button.excel:hover {
            background-color: #2E7D32;
        }

        footer { background-color: #f0f0f0; color: #777; padding: 15px 30px; font-size: 0.85em; text-align: center; }
        
        .guidance-container .content { padding: 30px; }
        .guidance-container h2 { font-size: 1.5em; color: var(--primary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-top:0; }
        .guidance-container h3, .guidance-container h4 { font-size: 1.2em; color: var(--secondary-color); margin-top: 25px; margin-bottom: 15px;}
        .guidance-container h4 { font-size: 1.1em; color: var(--primary-color); margin-top: 20px; }
        .guidance-container p, .guidance-container ul { line-height: 1.8; }
        .guidance-container ul { list-style-type: '‚úì '; padding-left: 25px; }
        .guidance-container li { margin-bottom: 10px; }
        .guidance-container .sub-list { list-style-type: '‚Ä¢ '; margin-top: 8px; }
        .formula { background-color: #eef; font-family: monospace; padding: 15px; border-radius: 6px; border: 1px solid #dbe3f8; text-align: center; margin: 15px 0; font-size: 1.1em; overflow-x: auto; }
        
        /* Print Styles */
        @media print {
            body {
                background-color: white; padding: 0; margin: 0;
                font-size: 10pt;
                 -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
            }
            .container, footer, .export-section, .tooltip-icon, header {
                display: none !important;
            }
            #print-area {
                display: block !important; box-shadow: none !important; border: none !important;
                width: 100%; max-width: 100%;
            }
            #print-header {
                text-align: center; margin-bottom: 25px;
                color: black;
            }
            #print-header h1 { font-size: 18pt; margin-bottom: 5px;}
            #print-header p { font-size: 11pt; margin-top: 0; }

            .print-section {
                 page-break-inside: avoid;
                 margin-bottom: 20px;
            }
            .print-fieldset {
                border: 1px solid #ccc !important; break-inside: avoid; margin-bottom: 20px; padding: 15px;
            }
            .print-fieldset legend { color: black !important; font-size: 1.3em; font-weight: bold; }
            .print-fieldset .result-value { color: #333 !important; }
            #print-guidance-wrapper h2, #print-guidance-wrapper h3, #print-guidance-wrapper h4 { color: black !important; border-color: #ccc !important; }
            #print-guidance-wrapper .formula { border: 1px solid #ccc !important; background-color: #f9f9f9 !important; }
        }
    </style>
</head>
<body>

    <div class="container calculator-container">
        <header>
            <h1>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πç‡πâ‡∏≤</h1>
            <p>‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô NFPA, FM ‡πÅ‡∏•‡∏∞ ‡∏ß‡∏™‡∏ó.</p>
        </header>

        <main>
            <section id="inputs">
                <fieldset>
                    <legend>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Input Data)</legend>
                    <div class="form-group full-width">
                        <label for="hazard_type">
                            <span class="label-text">1. ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢<span class="label-eng">Hazard Classification</span></span>
                            <div class="tooltip-icon">i<span class="tooltip-text">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà ‡∏°‡∏µ‡∏ú‡∏•‡∏ï‡πà‡∏≠‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</span></div>
                        </label>
                        <select id="hazard_type">
                            <option value="light">Light Hazard (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏ï‡πà‡∏≥)</option>
                            <option value="ordinary1">Ordinary Hazard Group 1 (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á 1)</option>
                            <option value="ordinary2">Ordinary Hazard Group 2 (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á 2)</option>
                            <option value="extra1">Extra Hazard Group 1 (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á 1)</option>
                            <option value="extra2">Extra Hazard Group 2 (‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á 2)</option>
                        </select>
                    </div>
                    <div class="form-group full-width">
                        <label for="density">
                             <span class="label-text">2. ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏â‡∏µ‡∏î‡∏ô‡πâ‡∏≥ [gpm/sq.ft]<span class="label-eng">Density (Ds)</span></span>
                             <div class="tooltip-icon">i<span class="tooltip-text">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ï‡πà‡∏≠‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏ï‡πà‡∏≤‡∏á‡πÜ</span></div>
                        </label>
                        <input type="number" id="density" step="0.01">
                    </div>
                    <div class="form-group full-width">
                        <label for="area_of_operation">
                             <span class="label-text">3. ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô [sq.ft]<span class="label-eng">Area of Operation (Ao)</span></span>
                             <div class="tooltip-icon">i<span class="tooltip-text">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏°‡∏°‡∏ï‡∏¥‡∏ó‡∏µ‡πà‡πÑ‡∏Å‡∏•‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏≤‡∏Å‡∏õ‡∏±‡πä‡∏° ‡∏ã‡∏∂‡πà‡∏á‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</span></div>
                        </label>
                        <input type="number" id="area_of_operation">
                    </div>
                    <div class="input-grid">
                        <div class="form-group">
                            <label for="spacing_s">
                                <span class="label-text">4. ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏±‡∏ß (S) [m]<span class="label-eng">Spacing (S)</span></span>
                                <div class="tooltip-icon">i<span class="tooltip-text">‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ö‡∏ô‡∏ó‡πà‡∏≠‡∏Å‡∏¥‡πà‡∏á‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô (‡∏´‡∏ô‡πà‡∏ß‡∏¢: ‡πÄ‡∏°‡∏ï‡∏£)</span></div>
                            </label>
                            <input type="number" id="spacing_s" value="3.0" step="0.1">
                            <p id="spacing_s_guidance" class="guidance-text"></p>
                        </div>
                        <div class="form-group">
                            <label for="spacing_l">
                                <span class="label-text">5. ‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏¥‡πà‡∏á (L) [m]<span class="label-eng">Spacing (L)</span></span>
                                <div class="tooltip-icon">i<span class="tooltip-text">‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏ó‡πà‡∏≠‡∏Å‡∏¥‡πà‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡πÄ‡∏™‡πâ‡∏ô (‡∏´‡∏ô‡πà‡∏ß‡∏¢: ‡πÄ‡∏°‡∏ï‡∏£)</span></div>
                            </label>
                            <input type="number" id="spacing_l" value="4.0" step="0.1">
                             <p id="spacing_l_guidance" class="guidance-text"></p>
                        </div>
                    </div>
                    <div class="form-group full-width">
                        <label for="coverage_area_display">
                             <span class="label-text">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡∏ï‡πà‡∏≠‡∏´‡∏±‡∏ß<span class="label-eng">Coverage Area (As)</span></span>
                        </label>
                        <input type="text" id="coverage_area_display" readonly>
                        <div id="area_warning" class="info-box"></div>
                    </div>
                     <div class="input-grid">
                        <div class="form-group">
                             <label for="hose_demand">
                                <span class="label-text">6. ‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î<span class="label-eng">Hose Demand</span></span>
                                <div class="tooltip-icon">i<span class="tooltip-text">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏ß‡πâ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÉ‡∏ä‡πâ‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î</span></div>
                            </label>
                            <select id="hose_demand">
                                <option value="100">100 gpm (Light Hazard)</option>
                                <option value="250">250 gpm (Ordinary Hazard)</option>
                                <option value="500">500 gpm (Extra Hazard)</option>
                            </select>
                        </div>
                        <div class="form-group">
                             <label for="k_factor">
                                <span class="label-text">7. K-Factor<span class="label-eng">K-Factor</span></span>
                                <div class="tooltip-icon">i<span class="tooltip-text">‡∏Ñ‡πà‡∏≤‡∏Ñ‡∏á‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå ‡∏ö‡∏≠‡∏Å‡∏ñ‡∏∂‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥</span></div>
                            </label>
                            <select id="k_factor">
                                <option value="5.6">5.6 (Standard)</option>
                                <option value="8.0">8.0 (Large Orifice)</option>
                                <option value="11.2">11.2 (ESFR/Storage)</option>
                            </select>
                        </div>
                    </div>
                     <div class="form-group full-width">
                         <label for="overage_factor">
                            <span class="label-text">8. Overage Factor</span>
                            <div class="tooltip-icon">i<span class="tooltip-text">‡∏ï‡∏±‡∏ß‡∏Ñ‡∏π‡∏ì‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì ‡∏°‡∏±‡∏Å‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô 1</span></div>
                        </label>
                        <input type="number" id="overage_factor" value="1.0" step="0.1">
                    </div>
                </fieldset>
            </section>

            <section id="results">
                <fieldset>
                    <legend>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì (Calculation Results)</legend>
                    <div class="form-group result-group">
                        <div class="label">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£<span class="label-eng">Sprinkler System Demand</span></div>
                        <div class="result-value">
                            <span id="sprinkler_demand_gpm"></span><span class="metric" id="sprinkler_demand_lpm"></span>
                        </div>
                    </div>
                    <div class="form-group result-group">
                        <div class="label">‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö<span class="label-eng">Total Demand</span></div>
                        <div class="result-value" id="total_demand_result">
                            <span id="total_demand_gpm"></span><span class="metric" id="total_demand_lpm"></span>
                        </div>
                    </div>
                     <div class="form-group result-group">
                        <div class="label">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏á‡∏≤‡∏ô<span class="label-eng">Number of Sprinklers</span></div>
                        <div class="result-value">
                            <span id="num_sprinklers"></span><span class="metric" id="num_sprinklers_rounded"></span>
                        </div>
                    </div>
                    <div class="form-group result-group">
                        <div class="label">‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢<span class="label-eng">End-Head Flow</span></div>
                        <div class="result-value">
                            <span id="end_head_flow_gpm"></span><span class="metric" id="end_head_flow_lpm"></span>
                        </div>
                    </div>
                    <div class="form-group result-group">
                        <div class="label">‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢<span class="label-eng">End-Head Start Pressure</span></div>
                        <div class="result-value" id="end_head_pressure_result">
                            <span id="end_head_pressure_psi"></span><span class="metric" id="end_head_pressure_bar"></span>
                        </div>
                        <div id="pressure_warning" class="pressure-warning">
                            <strong>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 7 psi (0.5 bar) ‡∏ã‡∏∂‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á NFPA
                        </div>
                        <div id="pressure_ok" class="pressure-ok">
                            <strong>‚úì</strong> ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏Ç‡∏≠‡∏á NFPA
                        </div>
                        <div id="suggestion_box" class="suggestion-box"></div>
                    </div>
                    <div class="export-section">
                        <button id="exportPdfBtn" class="pdf">üìÑ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô PDF</button>
                        <button id="exportExcelBtn" class="excel">üìä ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÄ‡∏õ‡πá‡∏ô Excel (.csv)</button>
                    </div>
                </fieldset>
            </section>
        </main>
    </div>

    <div class="container guidance-container" id="guidance-section">
        <div class="content">
            <h2>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (Reference & Application)</h2>
            
            <h3>‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô</h3>
            <p>‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏ô‡∏µ‡πâ‡∏≠‡πâ‡∏≤‡∏á‡∏≠‡∏¥‡∏á‡∏´‡∏•‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏• ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡πá‡∏ô‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÉ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≠‡πÑ‡∏õ:</p>
            <ul>
                <li><strong>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô (Density) ‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô (Area of Operation):</strong> ‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏à‡∏≤‡∏Å‡∏Å‡∏£‡∏≤‡∏ü <strong>Density/Area Curves ‡πÉ‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô NFPA 13</strong> ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡πÉ‡∏à‡∏Ç‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå ‡πÇ‡∏î‡∏¢‡∏à‡∏∞‡πÅ‡∏õ‡∏£‡∏ú‡∏±‡∏ô‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏Ç‡∏≠‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà (Hazard Classification)</li>
                <li><strong>‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î (Hose Demand):</strong> ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á (100, 250, ‡∏´‡∏£‡∏∑‡∏≠ 500 GPM) ‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ç‡∏≠‡∏á <strong>NFPA 13</strong> ‡∏ã‡∏∂‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏≥‡∏°‡∏≤‡∏ö‡∏ß‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏õ‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå</li>
                 <li><strong>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ (Minimum Start Pressure):</strong> ‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô <strong>NFPA 13</strong> ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏ß‡πà‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå (‡πÑ‡∏°‡πà‡∏ß‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏ß‡∏â‡∏µ‡∏î‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏±‡∏ß‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ó‡∏≤‡∏á) ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ <strong>7 psi (0.5 bar)</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏à‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡πÑ‡∏ß‡πâ</li>
                <li><strong>‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥ (Total Demand):</strong> ‡∏Ñ‡∏∑‡∏≠‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏Ç‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå (Sprinkler Demand) ‡πÅ‡∏•‡∏∞‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î (Hose Demand) ‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏à‡∏∏‡∏î‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô <strong>NFPA 20</strong></li>
                 <li><strong>‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô FM Global:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ö‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó ‡πÇ‡∏î‡∏¢‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏µ‡πà‡∏¢‡∏á‡∏™‡∏π‡∏á ‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏à‡∏≤‡∏Å <strong>FM Global Data Sheets (‡πÄ‡∏ä‡πà‡∏ô FM 2-0)</strong> ‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏î‡πâ‡∏ß‡∏¢ ‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏î‡πâ‡∏≤‡∏ô Density/Area ‡∏ó‡∏µ‡πà‡πÄ‡∏Ç‡πâ‡∏°‡∏á‡∏ß‡∏î‡∏Å‡∏ß‡πà‡∏≤ NFPA</li>
            </ul>

            <h3>‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡πÑ‡∏õ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≠</h3>
            <p>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ß‡∏¥‡∏®‡∏ß‡∏Å‡∏£‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡∏î‡∏™‡∏¥‡∏ô‡πÉ‡∏à‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏≠‡∏á‡∏Ñ‡πå‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏´‡∏•‡∏±‡∏Å‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:</p>

            <h4>1. ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏±‡πä‡∏°‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á (Fire Pump & Jockey Pump Selection)</h4>
            <p><strong>- Fire Pump:</strong></p>
            <ul>
                <li><strong>‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏• (Rated Flow):</strong> ‡πÉ‡∏ä‡πâ‡∏Ñ‡πà‡∏≤ <strong id="pump-demand-gpm"></strong> GPM (Total Demand) ‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∏‡πà‡∏ô‡∏Ç‡∏≠‡∏á Fire Pump ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ (‡πÄ‡∏ä‡πà‡∏ô ‡∏´‡∏≤‡∏Å‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ 650 GPM ‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏ä‡πâ‡∏õ‡∏±‡πä‡∏°‡∏Ç‡∏ô‡∏≤‡∏î 750 GPM)</li>
                <li><strong>‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô (Rated Pressure):</strong> ‡∏Ñ‡πà‡∏≤ <strong id="pump-pressure-psi"></strong> psi (End-Head Start Pressure) ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡πà‡∏≠ ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏´‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏™‡∏π‡∏ç‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏ô‡∏ó‡πà‡∏≠ (Friction Loss) ‡πÅ‡∏•‡∏∞‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏Ç‡∏≠‡∏á‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£ (Elevation Head) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà Fire Pump ‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÑ‡∏î‡πâ ‡∏ì ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô <strong>NFPA 20</strong></li>
            </ul>
             <p><strong>- Jockey Pump:</strong></p>
             <ul>
                 <li>‡∏õ‡∏±‡πä‡∏°‡∏£‡∏±‡∏Å‡∏©‡∏≤‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô (Jockey Pump) ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏µ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏ô‡πâ‡∏≠‡∏¢ (‡∏õ‡∏Å‡∏ï‡∏¥‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì 1% ‡∏Ç‡∏≠‡∏á Fire Pump) ‡πÅ‡∏ï‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏•‡πá‡∏Å‡∏ô‡πâ‡∏≠‡∏¢ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏£‡∏∞‡∏î‡∏±‡∏ö‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÉ‡∏ô‡πÄ‡∏™‡πâ‡∏ô‡∏ó‡πà‡∏≠‡πÅ‡∏•‡∏∞‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ Fire Pump ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</li>
             </ul>

            <h4>2. ‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á (Water Tank Sizing)</h4>
            <p>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏Å‡πÄ‡∏Å‡πá‡∏ö ‡∏à‡∏∞‡∏Ç‡∏∂‡πâ‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö Total Demand ‡πÅ‡∏•‡∏∞‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏Å‡∏≥‡∏´‡∏ô‡∏î</p>
            <div class="formula">
                ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á (‡∏•‡∏¥‡∏ï‡∏£) = ‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏£‡∏ß‡∏° (LPM) &times; ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ (‡∏ô‡∏≤‡∏ó‡∏µ)
            </div>
             <ul>
                 <li><strong>‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏à‡πà‡∏≤‡∏¢‡∏ô‡πâ‡∏≥ (Duration) ‡∏ï‡∏≤‡∏° NFPA 13:</strong>
                    <ul class="sub-list">
                        <li>Light Hazard: <strong>30 ‡∏ô‡∏≤‡∏ó‡∏µ</strong></li>
                        <li>Ordinary Hazard: <strong>60 - 90 ‡∏ô‡∏≤‡∏ó‡∏µ</strong></li>
                        <li>Extra Hazard: <strong>90 - 120 ‡∏ô‡∏≤‡∏ó‡∏µ</strong></li>
                    </ul>
                 </li>
                 <li>
                     <strong>‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á:</strong> ‡∏´‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏õ‡πá‡∏ô <strong id="example-hazard-name"></strong> ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡πâ‡∏≥ <strong id="example-lpm"></strong> LPM ‡πÅ‡∏•‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏ô‡∏≤‡∏ô <strong id="example-duration"></strong> ‡∏ô‡∏≤‡∏ó‡∏µ ‡∏à‡∏∞‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏ñ‡∏±‡∏á‡πÄ‡∏Å‡πá‡∏ö‡∏ô‡πâ‡∏≥‡∏Ç‡∏ô‡∏≤‡∏î‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ <strong id="example-tank-size"></strong> ‡∏•‡∏¥‡∏ï‡∏£
                 </li>
             </ul>
             
            <h4>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</h4>
            <ul>
                <li><strong>‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á‡∏à‡∏£‡∏¥‡∏á:</strong> ‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏∑‡∏≠‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ô‡πâ‡∏≥‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ (Net Usable Volume) ‡πÉ‡∏ô‡∏ó‡∏≤‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Ñ‡∏ß‡∏£‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô (‡πÄ‡∏ä‡πà‡∏ô 50,000 ‡∏•‡∏¥‡∏ï‡∏£, 75,000 ‡∏•‡∏¥‡∏ï‡∏£, 100,000 ‡∏•‡∏¥‡∏ï‡∏£) ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡πÑ‡∏°‡πà‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ô‡∏µ‡πâ</li>
                <li><strong>‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡πÄ‡∏ú‡∏∑‡πà‡∏≠:</strong> ‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏à‡∏£‡∏¥‡∏á‡∏≠‡∏≤‡∏à‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏ô‡πâ‡∏≥‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ (‡∏Å‡πâ‡∏ô‡∏ñ‡∏±‡∏á) ‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ï‡∏£‡∏≠‡∏≤‡∏Å‡∏≤‡∏® (Freeboard) ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏ã‡∏∂‡πà‡∏á‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á‡πÇ‡∏î‡∏¢‡∏£‡∏ß‡∏° (Gross Volume) ‡πÉ‡∏´‡∏ç‡πà‡∏Å‡∏ß‡πà‡∏≤‡∏Ñ‡πà‡∏≤‡∏ó‡∏µ‡πà‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÑ‡∏î‡πâ</li>
                <li><strong>‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô:</strong> ‡∏Ñ‡∏ß‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡∏≠‡∏á‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô‡∏ó‡πâ‡∏≠‡∏á‡∏ñ‡∏¥‡πà‡∏ô‡∏ã‡∏∂‡πà‡∏á‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß‡∏Å‡∏±‡∏ö‡∏Ç‡∏ô‡∏≤‡∏î‡∏ñ‡∏±‡∏á‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏ô‡πâ‡∏≥‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏à‡∏≤‡∏Å‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô‡∏™‡∏≤‡∏Å‡∏•</li>
            </ul>
        </div>
    </div>
    
    <div id="print-area" style="display: none;">
        <div id="print-header">
            <h1>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡∏±‡∏ö‡πÄ‡∏û‡∏•‡∏¥‡∏á‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡πâ‡∏≥</h1>
            <p id="print-date"></p>
        </div>
        <div id="print-inputs-wrapper" class="print-section"></div>
        <div id="print-results-wrapper" class="print-section"></div>
        <div id="print-guidance-wrapper" class="print-section"></div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- CONFIGURATION ---
            const M_TO_FT = 3.28084;
            const FT_TO_M = 1 / M_TO_FT;
            const GPM_TO_LPM = 3.785; 
            const PSI_TO_BAR = 0.0689476;
            const MIN_SPACING_M = 1.8; // 6 ft
            const MIN_PRESSURE_PSI = 7.0;

            const HAZARD_CONFIG = {
                light: { name: 'Light Hazard', density: 0.10, area: 1500, hose: 100, maxSpacing: 4.6, maxArea: 20.9, duration: 30 },
                ordinary1: { name: 'Ordinary Hazard Group 1', density: 0.15, area: 1500, hose: 250, maxSpacing: 4.6, maxArea: 12.1, duration: 90 },
                ordinary2: { name: 'Ordinary Hazard Group 2', density: 0.20, area: 1500, hose: 250, maxSpacing: 4.6, maxArea: 12.1, duration: 90 },
                extra1: { name: 'Extra Hazard Group 1', density: 0.30, area: 2500, hose: 500, maxSpacing: 3.7, maxArea: 9.3, duration: 120 },
                extra2: { name: 'Extra Hazard Group 2', density: 0.40, area: 2500, hose: 500, maxSpacing: 3.7, maxArea: 9.3, duration: 120 },
            };

            // --- DOM ELEMENTS ---
            const els = {
                hazardType: document.getElementById('hazard_type'),
                density: document.getElementById('density'),
                areaOfOperation: document.getElementById('area_of_operation'),
                spacingS: document.getElementById('spacing_s'),
                spacingL: document.getElementById('spacing_l'),
                spacingSGuidance: document.getElementById('spacing_s_guidance'),
                spacingLGuidance: document.getElementById('spacing_l_guidance'),
                coverageAreaDisplay: document.getElementById('coverage_area_display'),
                areaWarning: document.getElementById('area_warning'),
                hoseDemand: document.getElementById('hose_demand'),
                kFactor: document.getElementById('k_factor'),
                overageFactor: document.getElementById('overage_factor'),
                sprinklerDemandGpm: document.getElementById('sprinkler_demand_gpm'),
                sprinklerDemandLpm: document.getElementById('sprinkler_demand_lpm'),
                totalDemandGpm: document.getElementById('total_demand_gpm'),
                totalDemandLpm: document.getElementById('total_demand_lpm'),
                numSprinklers: document.getElementById('num_sprinklers'),
                numSprinklersRounded: document.getElementById('num_sprinklers_rounded'),
                endHeadFlowGpm: document.getElementById('end_head_flow_gpm'),
                endHeadFlowLpm: document.getElementById('end_head_flow_lpm'),
                endHeadPressurePsi: document.getElementById('end_head_pressure_psi'),
                endHeadPressureBar: document.getElementById('end_head_pressure_bar'),
                pressureWarning: document.getElementById('pressure_warning'),
                pressureOk: document.getElementById('pressure_ok'),
                suggestionBox: document.getElementById('suggestion_box'),
                exportPdfBtn: document.getElementById('exportPdfBtn'),
                exportExcelBtn: document.getElementById('exportExcelBtn')
            };

            // --- FUNCTIONS ---
            function updateHazardDefaults() {
                const hazard = els.hazardType.value;
                const config = HAZARD_CONFIG[hazard];
                if (config) {
                    els.density.value = config.density.toFixed(2);
                    els.areaOfOperation.value = config.area;
                    els.hoseDemand.value = config.hose;
                    updateSpacingGuidance();
                }
                calculateAll();
            }
            
            function mToFt(m) { return m * M_TO_FT; }
            function gpmToLpm(gpm) { return gpm * GPM_TO_LPM; }
            function psiToBar(psi) { return psi * PSI_TO_BAR; }

            function calculateAll() {
                // 1. Get all input values
                const hazard = els.hazardType.value;
                const density = parseFloat(els.density.value) || 0;
                const areaOfOp = parseFloat(els.areaOfOperation.value) || 0;
                const spacingS_m = parseFloat(els.spacingS.value) || 0;
                const spacingL_m = parseFloat(els.spacingL.value) || 0;
                const hose = parseInt(els.hoseDemand.value, 10) || 0;
                const kFactor = parseFloat(els.kFactor.value) || 0;
                const overageFactor = parseFloat(els.overageFactor.value) || 1.0;

                // 2. Intermediate Calculations
                const coverageArea_m2 = spacingS_m * spacingL_m;
                const coverageArea_sqft = mToFt(mToFt(coverageArea_m2));
                
                let numSprinklers = (coverageArea_sqft > 0) ? (areaOfOp / coverageArea_sqft) : 0;
                if (numSprinklers < 1 && areaOfOp > 0) numSprinklers = 1;
                const numSprinklersRounded = Math.ceil(numSprinklers);

                const sprinklerDemandGpm = density * areaOfOp * overageFactor;
                const totalDemandGpm = sprinklerDemandGpm + hose;
                const endHeadFlowGpm = density * coverageArea_sqft;
                const endHeadPressurePsi = kFactor > 0 ? Math.pow(endHeadFlowGpm / kFactor, 2) : 0;
                
                const config = HAZARD_CONFIG[hazard];
                const duration = config ? config.duration : 0;
                const tankSizeLiters = gpmToLpm(totalDemandGpm) * duration;

                // 3. Update UI - Main Results
                els.coverageAreaDisplay.value = `${coverageArea_m2.toFixed(2)} m¬≤ / ${coverageArea_sqft.toFixed(2)} sq.ft`;
                els.sprinklerDemandGpm.textContent = `${sprinklerDemandGpm.toFixed(2)} GPM`;
                els.sprinklerDemandLpm.textContent = `(${gpmToLpm(sprinklerDemandGpm).toFixed(2)} LPM)`;
                els.totalDemandGpm.textContent = `${totalDemandGpm.toFixed(2)} GPM`;
                els.totalDemandLpm.textContent = `(${gpmToLpm(totalDemandGpm).toFixed(2)} LPM)`;
                els.numSprinklers.textContent = `${numSprinklers.toFixed(2)}`;
                els.numSprinklersRounded.textContent = `(‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ${numSprinklersRounded} ‡∏´‡∏±‡∏ß)`;
                els.endHeadFlowGpm.textContent = `${endHeadFlowGpm.toFixed(2)} GPM`;
                els.endHeadFlowLpm.textContent = `(${gpmToLpm(endHeadFlowGpm).toFixed(2)} LPM)`;
                els.endHeadPressurePsi.textContent = `${endHeadPressurePsi.toFixed(2)} psi`;
                els.endHeadPressureBar.textContent = `(${psiToBar(endHeadPressurePsi).toFixed(2)} bar)`;

                // 4. Update UI - Warnings and Suggestions
                updateAreaWarning(coverageArea_m2);
                updatePressureWarning(endHeadPressurePsi, kFactor, endHeadFlowGpm);
                
                // 5. Update Guidance Section with all dynamic values
                updateGuidanceValues({
                    totalDemandGpm: totalDemandGpm.toFixed(2),
                    endHeadPressurePsi: endHeadPressurePsi.toFixed(2),
                    hazardName: config.name,
                    totalDemandLpm: gpmToLpm(totalDemandGpm).toFixed(2),
                    duration: duration,
                    tankSize: tankSizeLiters.toLocaleString('th-TH', { maximumFractionDigits: 0 })
                });
            }

            function updateSpacingGuidance() {
                const config = HAZARD_CONFIG[els.hazardType.value];
                if (!config) return;
                
                const guidanceText = `(‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô: ${MIN_SPACING_M} - ${config.maxSpacing} m)`;
                els.spacingSGuidance.textContent = guidanceText;
                els.spacingLGuidance.textContent = guidanceText;
            }

            function updateAreaWarning(area_m2) {
                const config = HAZARD_CONFIG[els.hazardType.value];
                if (!config) return;

                const maxArea = config.maxArea;
                const maxAreaFt = mToFt(mToFt(maxArea));
                
                if (area_m2 > maxArea) {
                    els.areaWarning.innerHTML = `<strong>‡∏Ñ‡∏≥‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</strong> ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏•‡∏∏‡∏°‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡πà‡∏≤‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö ${config.name} (${maxArea.toFixed(1)} m¬≤ ‡∏´‡∏£‡∏∑‡∏≠ ~${maxAreaFt.toFixed(0)} sq.ft)`;
                    els.areaWarning.style.display = 'block';
                } else {
                    els.areaWarning.style.display = 'none';
                }
            }
            
            function updatePressureWarning(pressure, k, q) {
                const isLow = pressure < MIN_PRESSURE_PSI && pressure > 0;
                els.pressureWarning.style.display = isLow ? 'block' : 'none';
                els.pressureOk.style.display = pressure >= MIN_PRESSURE_PSI ? 'block' : 'none';
                
                if (isLow && k > 0) {
                    const requiredK = q / Math.sqrt(MIN_PRESSURE_PSI);
                    let suggestionText = `<strong>‡∏Ç‡πâ‡∏≠‡πÄ‡∏™‡∏ô‡∏≠‡πÅ‡∏ô‡∏∞:</strong> ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡πà‡∏≥ ${MIN_PRESSURE_PSI} psi ‡∏Ñ‡∏ß‡∏£‡∏û‡∏¥‡∏à‡∏≤‡∏£‡∏ì‡∏≤:<ul>`;
                    suggestionText += `<li>1. ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡πà‡∏≤ K-Factor ‡πÉ‡∏´‡πâ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ${requiredK.toFixed(2)}</li>`;
                    suggestionText += `<li>2. ‡∏•‡∏î‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏Ç‡∏≠‡∏á‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏•‡∏î‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏• (q) ‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢</li></ul>`;
                    
                    els.suggestionBox.innerHTML = suggestionText;
                    els.suggestionBox.style.display = 'block';
                } else {
                    els.suggestionBox.style.display = 'none';
                }
            }
            
            function updateGuidanceValues(values) {
                // Section 1: Pump Selection
                document.getElementById('pump-demand-gpm').textContent = values.totalDemandGpm;
                document.getElementById('pump-pressure-psi').textContent = values.endHeadPressurePsi;

                // Section 2: Tank Sizing Example
                document.getElementById('example-hazard-name').textContent = values.hazardName;
                document.getElementById('example-lpm').textContent = values.totalDemandLpm;
                document.getElementById('example-duration').textContent = values.duration;
                document.getElementById('example-tank-size').textContent = values.tankSize;
            }

            function generateCsv() {
                const headers = [
                    "‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå (Parameter)", "‡∏Ñ‡πà‡∏≤ (Value)", "‡∏´‡∏ô‡πà‡∏ß‡∏¢ (Unit)",
                    "Parameter (English)", "Value", "Unit"
                ];
                
                const data = [
                    ["‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏≠‡∏±‡∏ô‡∏ï‡∏£‡∏≤‡∏¢", HAZARD_CONFIG[els.hazardType.value].name, "-", "Hazard Classification", HAZARD_CONFIG[els.hazardType.value].name, "-"],
                    ["‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÅ‡∏ô‡πà‡∏ô‡∏Å‡∏≤‡∏£‡∏â‡∏µ‡∏î‡∏ô‡πâ‡∏≥", els.density.value, "gpm/sq.ft", "Density (Ds)", els.density.value, "gpm/sq.ft"],
                    ["‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô", els.areaOfOperation.value, "sq.ft", "Area of Operation (Ao)", els.areaOfOperation.value, "sq.ft"],
                    ["‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏´‡∏±‡∏ß (S)", els.spacingS.value, "m", "Spacing (S)", els.spacingS.value, "m"],
                    ["‡∏£‡∏∞‡∏¢‡∏∞‡∏´‡πà‡∏≤‡∏á‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏Å‡∏¥‡πà‡∏á (L)", els.spacingL.value, "m", "Spacing (L)", els.spacingL.value, "m"],
                    ["K-Factor", els.kFactor.value, "-", "K-Factor", els.kFactor.value, "-"],
                    ["‡∏ô‡πâ‡∏≥‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏™‡∏≤‡∏¢‡∏â‡∏µ‡∏î", els.hoseDemand.value, "gpm", "Hose Demand", els.hoseDemand.value, "gpm"],
                    [],
                    ["‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì", "Result", "", "Calculation Result", "Result", ""],
                    ["‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£", els.sprinklerDemandGpm.textContent.replace(' GPM', ''), "GPM", "Sprinkler System Demand", els.sprinklerDemandGpm.textContent.replace(' GPM', ''), "GPM"],
                    ["‡∏õ‡∏£‡∏¥‡∏°‡∏≤‡∏ì‡∏ô‡πâ‡∏≥‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏£‡∏∞‡∏ö‡∏ö", els.totalDemandGpm.textContent.replace(' GPM', ''), "GPM", "Total Demand", els.totalDemandGpm.textContent.replace(' GPM', ''), "GPM"],
                    ["‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏´‡∏±‡∏ß‡∏™‡∏õ‡∏£‡∏¥‡∏á‡πÄ‡∏Å‡∏≠‡∏£‡πå", els.numSprinklersRounded.textContent.replace('(‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ', '').replace(' ‡∏´‡∏±‡∏ß)', ''), "‡∏´‡∏±‡∏ß", "Number of Sprinklers", els.numSprinklersRounded.textContent.replace('(‡∏õ‡∏±‡∏î‡∏Ç‡∏∂‡πâ‡∏ô ', '').replace(' ‡∏´‡∏±‡∏ß)', ''), "heads"],
                    ["‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÑ‡∏´‡∏•‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢", els.endHeadFlowGpm.textContent.replace(' GPM', ''), "GPM", "End-Head Flow", els.endHeadFlowGpm.textContent.replace(' GPM', ''), "GPM"],
                    ["‡πÅ‡∏£‡∏á‡∏î‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏´‡∏±‡∏ß‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢", els.endHeadPressurePsi.textContent.replace(' psi', ''), "psi", "End-Head Start Pressure", els.endHeadPressurePsi.textContent.replace(' psi', ''), "psi"],
                ];
                
                let csvContent = "data:text/csv;charset=utf-8,\uFEFF";
                csvContent += headers.join(",") + "\r\n";
                data.forEach(rowArray => {
                    let row = rowArray.join(",");
                    csvContent += row + "\r\n";
                });
                
                const encodedUri = encodeURI(csvContent);
                const link = document.createElement("a");
                link.setAttribute("href", encodedUri);
                link.setAttribute("download", "fire_protection_calculation.csv");
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
            
            function preparePrintContent() {
                document.getElementById('print-date').textContent = `‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏±‡∏î‡∏ó‡∏≥: ${new Date().toLocaleDateString('th-TH', { year: 'numeric', month: 'long', day: 'numeric', hour: '2-digit', minute: '2-digit' })}`;

                const inputsContent = document.getElementById('inputs').querySelector('fieldset').cloneNode(true);
                const resultsContent = document.getElementById('results').querySelector('fieldset').cloneNode(true);
                
                inputsContent.querySelectorAll('.tooltip-icon, .info-box').forEach(el => el.remove());
                resultsContent.querySelectorAll('.pressure-warning, .pressure-ok, .suggestion-box, .export-section').forEach(el => el.remove());
                
                inputsContent.className = 'print-fieldset';
                resultsContent.className = 'print-fieldset';

                const inputsWrapper = document.getElementById('print-inputs-wrapper');
                const resultsWrapper = document.getElementById('print-results-wrapper');
                const guidanceWrapper = document.getElementById('print-guidance-wrapper');
                
                inputsWrapper.innerHTML = '';
                resultsWrapper.innerHTML = '';
                guidanceWrapper.innerHTML = '';

                inputsWrapper.appendChild(inputsContent);
                resultsWrapper.appendChild(resultsContent);

                const guidanceContent = document.getElementById('guidance-section').querySelector('.content').cloneNode(true);
                guidanceWrapper.appendChild(guidanceContent);
            }

            // --- EVENT LISTENERS ---
            els.hazardType.addEventListener('change', updateHazardDefaults);
            [els.density, els.areaOfOperation, els.spacingS, els.spacingL, els.hoseDemand, els.kFactor, els.overageFactor].forEach(el => {
                el.addEventListener('input', calculateAll);
            });
            
            els.exportExcelBtn.addEventListener('click', generateCsv);

            els.exportPdfBtn.addEventListener('click', () => {
                preparePrintContent();
                window.print();
            });

            // --- INITIALIZATION ---
            updateHazardDefaults();
        });
    </script>

</body>
</html>
